@page "/fetchdata"
@using IMaoTai.Entity
@using IMaoTai.Domain
@using System.Windows.Threading;
@inject IMaoTai.Service.IAppointProjectService AppointProjectService

<PageTitle>Weather forecast</PageTitle>

<h1>Weather forecast</h1>

<p>This component demonstrates fetching data from the server.</p>

@if (_productList == null)
{
    <p><em>Loading...</em></p>
}
else
{
    <MDataTable Headers="_headers" Items="_productList" ItemsPerPage="5">
        <ItemColContent>
            @if (context.Header.Value == nameof(ProductEntity.Img))
            {
                <img src="@context.Item.Img" width="80" height="80" />
            }
            else
            {
                @context.Value
            }
        </ItemColContent>
    </MDataTable>
}

@code {
    private List<ProductEntity> _productList;

    private List<DataTableHeader<ProductEntity>> _headers = new()
    {
        new() { Text = "商品Code", Value = nameof(ProductEntity.Code) },
        new() { Text = "标题", Value = nameof(ProductEntity.Title) },
        new() { Text = "内容", Value = nameof(ProductEntity.Description),Ellipsis = new DataTableEllipsis() },
        new() { Text = "图片", Value = nameof(ProductEntity.Img) },
        new() { Text = "创建时间", Value = nameof(ProductEntity.Created)}
    };

    protected override async Task OnInitializedAsync()
    {
        _productList = AppointProjectViewModel.ProductList;
        await Task.CompletedTask;
    }
}
